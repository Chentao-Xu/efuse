# ebpf扩展方法   
# 指针   
verifier会追踪所有基于 `input` 和 `output` 派生出的指针变量   
为了防止越界访问，sBPF的JIT编译器会在每次指针解引用前插入原生指令做边界检查   
- 检查访问是否落在 `[input, input + length\_i)`   
   
长度 `length\_i` 是由应用层传入的，sBPF借助内核函数（如 `rw\_verify\_area` ）在传递到用户城区前对其进行验证   
   
为什么不用bpf helper函数？   
- 每一个helper函数都会在JIT时转换为一个真正的函数调用   
- 大量使用helper会显著增加开销，影响性能   
   
# 动态长度循环   
允许动态长度循环   
- 允许回跳指令，即跳转指令offset为负   
- 静态verifier不再阻止这类跳转，改为由JIT插装控制   
   
引入循环控制器   
- 对每条 jump-back 指令插入一个计数器   
- 每次跳回循环时计数器加一   
- 一旦超过设定阈值，程序被中止   
   
阈值的设置方式   
- 对于典型的ISC程序，循环长度往往和 input 缓冲区长度呈正比   
- 可以设置为一个与最大输入缓冲区大小相同的数量级的值   
